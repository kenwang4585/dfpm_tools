
<!-- Ken wang, Oct, 2020 -->

{% extends 'base.html' %}

{% block content %}
        <table style="border-collapse:collapse" border="0" cellspacing="0px" width="90%" align="center">
                <tr>
                  <td align="left" width="100%">
                        {% if get_flashed_messages()|length>0 %}
                          {% for message in get_flashed_messages(with_categories=True) %}
                            <div class="alert alert-{{ message[0] }}" role="alert">
                                <button type="button" class="close" data-dismiss="alert">&times;</button>
                                {{ message[1] }}
                            </div>
                          {% endfor %}
                        {% endif %}
                  </td>
                </tr>
        </table>



    <form method="post" enctype="multipart/form-data">
        {{ form.csrf_token }}
        <table style="border-collapse:collapse" border="0" cellspacing="0px" width="90%" align="center">
            <tr>
                    <td>
                        <br><br>
                        <p><strong> Delete files:</strong></p>
                                <table width="740" border="0" cellspacing="1px" align="left" style="border-color: #c5c5c5;">
                                    <tr>
                                        <td align="left" width="90%">
                                            {{ form.file_name (class='form-control')}}
                                        </td>
                                        <td align="center" width="10%">
                                            {{ form.submit_delete (class='btn-primary btn-sm')}}
                                        </td>
                                    </tr>
                                </table>
                    </td>
                </tr>

                <tr>  <!-- For downloading the 3a4 resut files -->
                    <td width="95%">
                        <br><br><br>
                            {% if files_dfpm_3a4|length>0 %}
                                <p><strong> Created 3a4 files:</strong></p>
                                <table border="1" cellspacing="1px" align="left" style="border-color: #c5c5c5;">
                                        <tr>
                                            <td width="300"><span style="font-size: large;">&nbsp;&nbsp;File name</span></td>
                                            <td width="200"><span style="font-size: large">&nbsp;&nbsp;Creation time</span></td>
                                            <td width="120"><span style="font-size: large">&nbsp;&nbsp;File size</span></td>
                                            <td width="120">&nbsp;&nbsp;File download</td>
                                        </tr>
                                        {% for row in files_dfpm_3a4 %}
                                            <tr>
                                                {% for col in row[:3] %}
                                                    <td><span style="font-size: small">&nbsp;&nbsp;&nbsp;{{col}}</span></td>
                                                {% endfor %}
                                                <td align="center">
                                                    <a href="{{ url_for('download_file_output',filename=row[0]) }}">download</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                </table>
                            {% endif %}
                    </td>
                </tr>


                <tr> <!-- For downloading uploaded input data files -->
                    <td width="95%">
                        <br><br><br>
                                {% if files_uploaded|length>0 %}
                                    <p><strong> 3A4 files uploaded by user:</strong></p>
                                    <table style="border-collapse:collapse" border="1" cellspacing="0px" align="left">
                                        <tr>
                                            <td width="300"><span style="font-size: large;">&nbsp;&nbsp;File name</span></td>
                                            <td width="200"><span style="font-size: large">&nbsp;&nbsp;Creation time</span></td>
                                            <td width="120"><span style="font-size: large">&nbsp;&nbsp;File size</span></td>
                                            <td width="120">&nbsp;&nbsp;File download</td>
                                        </tr>
                                        {% for row in files_uploaded %}
                                            <tr>
                                                {% for col in row[:3] %}
                                                    <td><span style="font-size: small">&nbsp;&nbsp;&nbsp;{{col}}</span></td>
                                                {% endfor %}
                                                <td align="center">
                                                    <a href="{{ url_for('download_file_upload',filename=row[0]) }}">download</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </table>
                                {% endif %}
                    </td>
                </tr>


                <tr> <!-- For downloading tracker files -->
                    <td width="95%">
                        <br><br><br>
                                {% if files_tracker|length>0 %}
                                    <p><strong> Tracker files:</strong></p>
                                    <table style="border-collapse:collapse" border="1" cellspacing="0px" align="left">
                                        <tr>
                                            <td width="300"><span style="font-size: large;">&nbsp;&nbsp;File name</span></td>
                                            <td width="200"><span style="font-size: large">&nbsp;&nbsp;Creation time</span></td>
                                            <td width="120"><span style="font-size: large">&nbsp;&nbsp;File size</span></td>
                                            <td width="120">&nbsp;&nbsp;File download</td>
                                        </tr>
                                        {% for row in files_tracker %}
                                            <tr>
                                                {% for col in row[:3] %}
                                                    <td><span style="font-size: small">&nbsp;&nbsp;&nbsp;{{col}}</span></td>
                                                {% endfor %}
                                                <td align="center">
                                                    <a href="{{ url_for('download_file_tracker',filename=row[0]) }}">download</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </table>
                                {% endif %}
                    </td>
                </tr>

                <tr> <!-- For downloading log data files -->
                    <td width="100%">
                        <br><br><br>
                                {% if files_logs|length>0 %}
                                    <p><strong> Log files:</strong></p>
                                    <table style="border-collapse:collapse" border="1" cellspacing="0px" align="left">
                                        <tr>
                                            <td width="300"><span style="font-size: large;">&nbsp;&nbsp;File name</span></td>
                                            <td width="200"><span style="font-size: large">&nbsp;&nbsp;Creation time</span></td>
                                            <td width="120"><span style="font-size: large">&nbsp;&nbsp;File size</span></td>
                                            <td width="120">&nbsp;&nbsp;File download</td>
                                        </tr>
                                        {% for row in files_logs %}
                                            <tr>
                                                {% for col in row[:3] %}
                                                    <td><span style="font-size: small">&nbsp;&nbsp;&nbsp;{{col}}</span></td>
                                                {% endfor %}
                                                <td align="center">
                                                    <a href="{{ url_for('download_file_logs',filename=row[0]) }}">download</a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </table>
                                {% endif %}
                    </td>
                </tr>

                <tr> <!-- For viewing the log details -->
                    <td width="95%">
                        <br><br><br>
                                {% if log_details|length>0 %}
                                    <p><strong> Log details:</strong></p>
                                    <table style="border-collapse:collapse; word-break: break-all; word-wrap: break-word" border="1" cellspacing="0px" align="left">
                                        <tr>
                                            <td><span style="font-size: large;">&nbsp;&nbsp;id</span></td>
                                            <td><span style="font-size: large;">&nbsp;&nbsp;User id</span></td>
                                            <td><span style="font-size: large">&nbsp;&nbsp;Date</span></td>
                                            <td><span style="font-size: large">&nbsp;&nbsp;Time</span></td>
                                            <td><span style="font-size: large">&nbsp;&nbsp;Location</span></td>
                                            <td><span style="font-size: large">&nbsp;&nbsp;User action</span></td>
                                            <td><span style="font-size: large">&nbsp;&nbsp;Summary</span></td>
                                        </tr>
                                        {% for row in log_details %}
                                            <tr>
                                                {% for col in row %}
                                                    <td><span style="font-size: small">&nbsp;&nbsp;&nbsp;{{col}}</span></td>
                                                {% endfor %}
                                            </tr>
                                        {% endfor %}
                                    </table>
                                {% endif %}
                    </td>
                </tr>
        </table>
    </form>

{% endblock %}

{% block flash_message %}
{% endblock %}